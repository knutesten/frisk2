webpackJsonp([2],{92:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var u=n(110),a=o(u);t["default"]=function(e,t,n){return t in e?(0,a["default"])(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},141:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){return fetch(e,{method:"POST",body:(0,i["default"])(t),headers:c()}).then(function(e){return e.json()})}function a(e){return fetch(e,{headers:c()}).then(function(e){return e.json()})}function r(e){return fetch(e,{method:"DELETE",headers:c()})}Object.defineProperty(t,"__esModule",{value:!0});var d=n(142),i=o(d);t.fetchPost=u,t.fetchGet=a,t.fetchDelete=r;var c=function(){return new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt-token")})}},142:function(e,t,n){e.exports={"default":n(149),__esModule:!0}},149:function(e,t,n){var o=n(17),u=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return u.stringify.apply(u,arguments)}},189:function(e,t){e.exports={percentageColumn:"HomeView__percentageColumn___2OF4c",logConsumptionContainer:"HomeView__logConsumptionContainer___29H5C",consumptionTableContainer:"HomeView__consumptionTableContainer___30Zcu",leaderboardTableContainer:"HomeView__leaderboardTableContainer___K2ilb",undoButton:"HomeView__undoButton___3pqaT"}},223:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return{type:_,payload:e}}function a(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return{type:y,payload:e}}function r(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return{type:m,payload:e}}function d(){var e=arguments.length<=0||void 0===arguments[0]?T:arguments[0],t=arguments[1],n=L[t.type];return n?n(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),t.actions=t.createUndoLogConsumptionOnClick=t.createLogConsumptionOnClick=t.fetchTypesAsync=t.fetchLeaderboardAsync=t.fetchLogAsync=t.FETCH_LEADERBOARD=t.FETCH_TYPES=t.FETCH_LOG=void 0;var i,c=n(92),f=o(c),l=n(146),s=o(l),p=n(111),h=o(p);t.fetchLog=u,t.fetchLeaderboard=a,t.fetchTypes=r,t["default"]=d;var v=n(141),_=t.FETCH_LOG="FETCH_LOG",m=t.FETCH_TYPES="FETCH_TYPE",y=t.FETCH_LEADERBOARD="FETCH_LEADERBOARD",C=t.fetchLogAsync=function(){return function(e){return new h["default"](function(t){(0,v.fetchGet)("/api/log").then(function(n){e(u(n)),t()})})}},g=t.fetchLeaderboardAsync=function(){return function(e){return new h["default"](function(t){(0,v.fetchGet)("/api/leaderboard").then(function(n){e(a(n)),t()})})}},b=t.fetchTypesAsync=function(){return function(e){return new h["default"](function(t){(0,v.fetchGet)("/api/type").then(function(n){e(r(n)),t()})})}},L=(t.createLogConsumptionOnClick=function(e){return function(){return function(){return new h["default"](function(t){(0,v.fetchPost)("/api/log",e),t()})}}},t.createUndoLogConsumptionOnClick=function(){return function(){return function(){return new h["default"](function(e){(0,v.fetchDelete)("/api/log/undo"),e()})}}},t.actions={fetchLog:u,fetchLogAsync:C,fetchLeaderboard:a,fetchLeaderboardAsync:g,fetchTypes:r,fetchTypesAsync:b},i={},(0,f["default"])(i,_,function(e,t){return(0,s["default"])({},e,{log:t.payload})}),(0,f["default"])(i,y,function(e,t){return(0,s["default"])({},e,{leaderboard:t.payload})}),(0,f["default"])(i,m,function(e,t){return(0,s["default"])({},e,{types:t.payload})}),i),T={log:[],leaderboard:[],types:[]}},330:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(38),a=o(u),r=n(143),d=o(r),i=n(144),c=o(i),f=n(145),l=o(f),s=n(148),p=o(s),h=n(147),v=o(h),_=n(2),m=o(_),y=n(340),C=o(y),g=n(341),b=o(g),L=n(189),T=o(L),O=(0,a["default"])("h4",{},void 0,"Log consumption"),A=function(e){function t(){return(0,c["default"])(this,t),(0,p["default"])(this,(0,d["default"])(t).apply(this,arguments))}return(0,v["default"])(t,e),(0,l["default"])(t,[{key:"componentDidMount",value:function(){var e=this;this.props.fetchLogAsync(),this.props.fetchLeaderboardAsync(),this.props.fetchTypesAsync(),this.socket=new WebSocket("ws://frisk2.herokuapp.com/api/update"),this.socket.onmessage=function(t){"update"===t.data&&(e.props.fetchLeaderboardAsync(),e.props.fetchLogAsync())}}},{key:"componentWillUnmount",value:function(){this.socket.close()}},{key:"render",value:function(){var e=this,t=T["default"].undoButton+" button-primary";return(0,a["default"])("div",{},void 0,(0,a["default"])("div",{className:T["default"].logConsumptionContainer},void 0,O,this.props.home.types.map(function(t){return(0,a["default"])("button",{onClick:e.props.createLogConsumptionOnClick(t)},t.id,t.name)}),(0,a["default"])("button",{className:t,onClick:this.props.createUndoLogConsumptionOnClick()},void 0,"Undo")),(0,a["default"])("div",{className:"row"},void 0,(0,a["default"])("div",{className:"one-half column"},void 0,(0,a["default"])(C["default"],{log:this.props.home.log})),(0,a["default"])("div",{className:"one-half column"},void 0,(0,a["default"])(b["default"],{leaderboard:this.props.home.leaderboard}))))}}]),t}(m["default"].Component);t["default"]=A},340:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e){return(0,r["default"])("div",{className:c["default"].consumptionTableContainer},void 0,f,(0,r["default"])("table",{className:"u-full-width"},void 0,l,(0,r["default"])("tbody",{},void 0,e.log.map(function(e){return(0,r["default"])("tr",{},e.id,(0,r["default"])("td",{},void 0,e.user.username),(0,r["default"])("td",{},void 0,e.type.name),(0,r["default"])("td",{},void 0,new Date(e.date).toISOString().slice(0,19).replace("T"," ")))}))))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=o(a),d=n(2),i=(o(d),n(189)),c=o(i),f=(0,r["default"])("h4",{},void 0,"Recent consumption"),l=(0,r["default"])("thead",{},void 0,(0,r["default"])("tr",{},void 0,(0,r["default"])("th",{},void 0,"User"),(0,r["default"])("th",{},void 0,"Type"),(0,r["default"])("th",{},void 0,"Date")));t["default"]=u},341:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e){return(0,r["default"])("div",{className:c["default"].leaderboardTableContainer},void 0,f,(0,r["default"])("table",{className:"u-full-width"},void 0,l,(0,r["default"])("tbody",{},void 0,e.leaderboard.map(function(e,t){return(0,r["default"])("tr",{},e.user.id,(0,r["default"])("td",{},void 0,t+1),(0,r["default"])("td",{},void 0,e.user.username),(0,r["default"])("td",{},void 0,e.totalConsumption),(0,r["default"])("td",{className:c["default"].percentageColumn},void 0,(Math.round(100*e.percentageOfAllConsumption)/100).toFixed(2)," %"))}))))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=o(a),d=n(2),i=(o(d),n(189)),c=o(i),f=(0,r["default"])("h4",{},void 0,"Leaderboard"),l=(0,r["default"])("thead",{},void 0,(0,r["default"])("tr",{},void 0,(0,r["default"])("th",{},void 0,"#"),(0,r["default"])("th",{},void 0,"User"),(0,r["default"])("th",{},void 0,"Total"),(0,r["default"])("th",{},void 0,"Percentage of all")));t["default"]=u},342:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(103),a=n(223),r=n(330),d=o(r),i={fetchLogAsync:a.fetchLogAsync,fetchLeaderboardAsync:a.fetchLeaderboardAsync,fetchTypesAsync:a.fetchTypesAsync,createLogConsumptionOnClick:a.createLogConsumptionOnClick,createUndoLogConsumptionOnClick:a.createUndoLogConsumptionOnClick},c=function(e){return{home:e.home}};t["default"]=(0,u.connect)(c,i)(d["default"])}});